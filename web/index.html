
<!DOCTYPE html>
<html>
    <head>
        <meta charset ="utf-8">

        <title>Đồ án nhiệt độ và độ ẩm dùng ESP8266</title>
        <link rel ="stylesheet" href ="style.css">

    </head>
    <body>
        <div id = "menu_top">
        <ul>
            <li><a href="#" title ="Trang chủ" >Home</a> </li>
            <li><a href="http://192.168.100.5:8077/test1/view.php" target="_blank" title ="Data" >Data</a> </li>
        </ul>
        </div>
        <div id = "banner">
            <img src= "https://i.imgur.com/0N51VCT.png"/>
        </div>

        <div id = "main">
        <div id="main_left">
            <ul>
                <li>
                    <h1></h1>
                </li>
                <li>
                    <img src="https://i.imgur.com/byifRzR.png" width="100" height="100"/>
                    <h2>Temperature:<span id="temp"></span>*C</h2>
                </li>
                <li>
                    <img src="https://i.imgur.com/r6O9bzn.png"width="100" height="100"/>
                    <h2>Humidity:<span id="hum"></span>%</h2>
                </li>
                <li>
                    <img src="https://i.imgur.com/Q92kdIi.png"width="100" height="100"/>
                    <h2>Soil moisture: <span id="soil"></span>%</h2>

                </li>
                <li>
                    <img src="https://i.imgur.com/gRoFvxV.png"width="100" height="100"/>
                    <h2>Lamp:<span id="trangthaiD2"></span> </h2>
                    <h3 >
                        <span >
                            <button onclick="getdata('onD2')" class = "button1">ON</button>
                        </span>
                        <span >
                            <button onclick="getdata('offD2')" class = "button2">OFF</button>
                        </span>

                    </h3>
                </li>
                <li>
                    <img src="https://i.imgur.com/2CfgPZH.png"width="100" height="100"/>
                    <h2>Motor:<span id="trangthaiD5"></span></h2>
                    <h3 >
                        <span >
                            <button onclick="getdata('onD5')" class = "button1">ON</button>
                        </span>
                         <span >
                            <button onclick="getdata('offD5')" class = "button2">OFF</button>
                        </span>
                    </h3>
                </li>
                <li>
                    <img src="https://i.imgur.com/2CfgPZH.png"width="100" height="100"/>
                    <h2>Automatic:<span id="trangthaiD1"></span></h2>
                    <h3 >
                        <span >
                            <button onclick="getdata('onD1')" class = "button1">ON</button>
                        </span>
                         <span>
                            <button onclick="getdata('offD1')" class = "button2">OFF</button>
                        </span>
                    </h3>
                </li>
            </ul >
            </div>
            </div>

    
    </body>
    <script>
  
                  //-----------Tạo đối tượng request----------------
        function create_obj(){
          td = navigator.appName;
          if(td == "Microsoft Internet Explorer"){
            obj = new ActiveXObject("Microsoft.XMLHTTP");
          }else{
            obj = new XMLHttpRequest();
          }
          return obj;
        }
        var xhttp = create_obj();
        //-----------Thiết lập dữ liệu và gửi request-------
        function getdata(url){
          xhttp.open("GET","/"+url,true);
          xhttp.onreadystatechange = process;//nhận reponse 
          xhttp.send();
        }
        //-----------Kiểm tra response--------------------
        function process(){
          if(xhttp.readyState == 4 && xhttp.status == 200){
            //------Updat data sử dụng javascript----------
            ketqua = xhttp.responseText; 
            document.getElementById("reponsetext").innerHTML=ketqua;       
          }
        }  
            
            
            function getstatusD2D5(){
          xhttp.open("GET","/getstatusD2D5",true);
          xhttp.onreadystatechange = process_json;
          xhttp.send();
        }
        //-----------Kiểm tra response-------------------------------
        function process_json(){
          if(xhttp.readyState == 4 && xhttp.status == 200){
            //------Update data sử dụng javascript-------------------
            var trangthaiD2D5_JSON = xhttp.responseText;
            var Obj = JSON.parse(trangthaiD2D5_JSON);
            document.getElementById("trangthaiD2").innerHTML = Obj.D2;
            document.getElementById("trangthaiD5").innerHTML = Obj.D5;
            document.getElementById("trangthaiD1").innerHTML = Obj.D1;
            document.getElementById("temp").innerHTML = Obj.temp;
            document.getElementById("hum").innerHTML = Obj.hum;
            document.getElementById("soil").innerHTML = Obj.soil;
            
          }
        }
        //---Ham update duu lieu tu dong---
        setInterval(function() {
          getstatusD2D5();
        }, 1000);
    
    
    
    
    </script>






    
</html>
